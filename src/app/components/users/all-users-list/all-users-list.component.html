<div class="container mt-4 user-list-container">
  <div *ngIf="allUsersList | async as users; else loading">
    <ng-container *ngIf="users.length > 0; else noUsers">
      <div class="user-list">
        <div *ngFor="let user of users" class="user-card">
          <div class="user-avatar">
            <img [src]="'assets/default-avatar.png'" alt="Avatar" />
          </div>
          <div class="user-details">
            <h3 class="user-nickname">{{ user.nickname }}</h3>
            <p class="user-username">{{ user.username }}</p>
          </div>
          <div class="user-actions">
            <button class="btn btn-sm btn-primary" (click)="navigateToUserInfo(user)">‚ÑπÔ∏è –ü—Ä–æ—Ñ—ñ–ª—å</button>
            <button *ngIf="isAuthenticated | async" class="btn btn-sm btn-secondary" (click)="navigateToChat(user)">üí¨ –ß–∞—Ç</button>
            <button *ngIf="(isAuthenticated | async) && user.friend_info === null"
                    class="btn btn-sm btn-success" (click)="addUserToMyFriends(user.id)">
              ‚ûï –î–æ–¥–∞—Ç–∏
            </button>
            <button *ngIf="(isAuthenticated | async) && user.friend_info?.status === 'accepted'"
                    class="btn btn-sm btn-danger" (click)="removeUserFromMyFriends(user.id)">
              ‚ùå –í–∏–¥–∞–ª–∏—Ç–∏
            </button>
            <button *ngIf="(isAuthenticated | async) && user.friend_info?.status === 'pending' && user.friend_info?.offer_code"
                    class="btn btn-sm btn-warning" (click)="cancelFriendRequest(user.friend_info?.offer_code!)">
              üîÑ –û—á—ñ–∫—É—î
            </button>
            <button *ngIf="(isAuthenticated | async)" class="btn btn-sm btn-dark" (click)="blockUser(user.id!)">
              ‚õî –ë–ª–æ–∫—É–≤–∞—Ç–∏
            </button>
          </div>
        </div>
      </div>
    </ng-container>
  </div>

  <ng-template #loading>
    <div class="loading-container">
      <div class="spinner"></div>
      <p>–ó–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è...</p>
    </div>
  </ng-template>

  <ng-template #noUsers>
    <div class="alert alert-warning text-center mt-4">
      ‚ùóÔ∏è –ù–µ–º–∞—î –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á—ñ–≤
    </div>
  </ng-template>
</div>
